<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ソシャゲ風ガチャ</title>
    <style>
        body { background: #222; color: white; font-family: sans-serif; margin: 0; overflow: hidden; }
        
        /* 共通：画面中央配置 */
        .screen {
            display: none; /* 基本は非表示 */
            width: 100vw;
            height: 100vh;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* アクティブな画面だけ表示 */
        .active { display: flex; }

        /* --- ガチャTOP画面 --- */
        #lobby-screen { background: linear-gradient(to bottom, #1a2a6c, #b21f1f, #fdbb2d); }
        .banner { width: 300px; height: 150px; background: rgba(255,255,255,0.1); border: 2px solid white; margin-bottom: 20px; display: flex; align-items: center; justify-content: center; }
        .btn-group { display: flex; gap: 20px; }
        button { padding: 15px 30px; font-size: 18px; cursor: pointer; border-radius: 10px; border: none; font-weight: bold; background: #fff; }

        /* --- 結果画面 --- */
        #result-screen { background: #111; position: relative; }
        #result-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        .card { width: 100px; height: 140px; background: #444; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold; }
        .r { background: #888; }
        .sr { background: #f5576c; border: 2px solid #ff0; }
        .ssr { background: gold; color: black; box-shadow: 0 0 20px gold; }

        /* 戻るボタン */
        .back-btn { position: absolute; bottom: 40px; background: #555; color: white; }

        /* 演出用：召喚中テキスト */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center;
            z-index: 100; font-size: 30px; font-weight: bold;
        }
    </style>
</head>
<body>

<div id="lobby-screen" class="screen active">
    <div class="banner">期間限定ガチャ！</div>
    <div class="btn-group">
        <button onclick="startGacha(1)">1回召喚</button>
        <button onclick="startGacha(10)" style="background: #ffaa00;">10回召喚</button>
    </div>
</div>

<div id="overlay">召喚中...</div>

<div id="result-screen" class="screen">
    <div id="result-container"></div>
    <button class="back-btn" onclick="toLobby()">ガチャ画面に戻る</button>
</div>

<script>
    const lobbyScreen = document.getElementById('lobby-screen');
    const resultScreen = document.getElementById('result-screen');
    const resultContainer = document.getElementById('result-container');
    const overlay = document.getElementById('overlay');

    // ガチャ実行
    async function startGacha(count) {
        // 1. 演出開始（召喚中...）
        overlay.style.display = "flex";
        
        // 2. 内部で結果を計算
        const results = [];
        const rates = { ssr: 0.03, sr: 0.17 };
        for (let i = 0; i < count; i++) {
            const rand = Math.random();
            let rarity = rand < rates.ssr ? "ssr" : (rand < rates.ssr + rates.sr ? "sr" : "r");
            results.push(rarity);
        }

        // 3. 待ち時間（演出の代わり）
        await new Promise(r => setTimeout(r, 1500));

        // 4. 結果表示
        overlay.style.display = "none";
        lobbyScreen.classList.remove('active');
        resultScreen.classList.add('active');

        // コンテナをクリア
        resultContainer.innerHTML = "";
        // 単発の場合は中央に1枚だけ出すためのスタイル調整
        resultContainer.style.gridTemplateColumns = count === 1 ? "1fr" : "repeat(5, 1fr)";

        // 1枚ずつ表示
        for (const rarity of results) {
            const card = document.createElement('div');
            card.className = `card ${rarity}`;
            card.innerText = rarity.toUpperCase();
            resultContainer.appendChild(card);
            await new Promise(r => setTimeout(r, 1500 / count)); // 10連ならサクサク、1連ならじっくり
        }
    }

    // ロビーに戻る
    function toLobby() {
        resultScreen.classList.remove('active');
        lobbyScreen.classList.add('active');
    }
</script>

</body>
</html>
